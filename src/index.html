<!DOCTYPE html>
<!-- saved from url=(0042)https://www.npmjs.org/package/grunt-usemin -->
<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <title>grunt-usemin</title>

    <!-- build:css css/test.css -->
    <link rel="canonical" href="./grunt-usemin_files/grunt-usemin.html">
    <link type="text/css" rel="stylesheet" media="all" href="css//normalize.css">
    <link type="text/css" rel="stylesheet" media="all" href="css//index.css">
    <link type="text/css" rel="stylesheet" media="all" href="css//sh.css">
    <link type="text/css" rel="stylesheet" media="all" href="css//charts.css">
    <!-- endbuild -->
    <link rel="search" type="application/opensearchdescription+xml" href="https://www.npmjs.org/static/opensearch.xml"
          title="Search Packages">


</head>
<body>
<div id="wrap">
<div id="content">
<nav>
    <ul>
        <li class="npm current">
            <a href="https://www.npmjs.org/">Home</a>
        </li>
        <li class="docs">
            <a href="http://npmjs.org/doc/">API</a>
        </li>
        <li class="blog">
            <a href="http://blog.npmjs.org/">Blog</a>
        </li>
        <li class="logos">
            <a href="http://nodejs.org/">Node.js</a>
        </li>
        <li class="jobs">
            <a href="http://www.npmjs.com/jobs/?__hstc=212178187.98d862823a5ca5c9bca8ba1f3c4db76a.1414424434702.1415532056694.1415538703845.3&__hssc=212178187.10.1415538703845&__hsfp=3086852494">Jobs</a>
        </li>
    </ul>

    <ul class="hiring">
        <li class="hiring-group">
            <a href="https://www.npmjs.org/whoshiring">Who's Hiring</a>
        </li>

        <li data-id="lob" class="hiring-company">
            <a href="https://www.lob.com/jobs">
                <span>lob.com</span>
            </a>
        </li>
        <li class="hiring-more">
            <a href="https://www.npmjs.org/whoshiring">+ 14 More...</a>
        </li>

    </ul>

    <ul class="npme">
        <li class="npme-group">
            <a href="https://www.npmjs.org/enterprise">npm Enterprise</a>
        </li>
        <li class="npme-details">
            <a href="https://www.npmjs.org/enterprise">Try the on-premises solution for private npm.</a>
        </li>
    </ul>
</nav>

<aside class="login">

    <div class="user profile">
        <img src="img/avatar.jpg?__inline" class="avatar-medium"> <a href="https://www.npmjs.org/signup">Create Account</a> | <a
            href="https://www.npmjs.org/login">Login</a>
    </div>

</aside>


<div id="page">
<header>
    <form action="https://www.npmjs.org/search" method="get" id="search-container">
        <div id="package-search">

            <span class="twitter-typeahead" style="position: relative; display: inline-block; direction: ltr;"><input
                    type="search" class="typeahead search-input tt-hint" autocapitalize="off" autocorrect="off"
                    tabindex="1" disabled="" autocomplete="off" spellcheck="false"
                    style="position: absolute; top: 0px; left: 0px; border-color: transparent; box-shadow: none; background: none 0% 0% / auto repeat scroll padding-box border-box rgb(255, 255, 255);"><input
                    name="q" type="search" class="typeahead search-input tt-input" placeholder="Search Packages"
                    autocapitalize="off" autocorrect="off" tabindex="1" autocomplete="off" spellcheck="false" dir="auto"
                    style="position: relative; vertical-align: top; background-color: transparent;"><pre
                    aria-hidden="true"
                    style="position: absolute; visibility: hidden; white-space: pre; font-family: Georgia, serif; font-size: 18px; font-style: normal; font-variant: normal; font-weight: 400; word-spacing: 0px; letter-spacing: 0px; text-indent: 0px; text-rendering: auto; text-transform: none;"></pre><span
                    class="tt-dropdown-menu"
                    style="position: absolute; top: 100%; z-index: 100; display: none; left: 0px; right: auto;"><div
                    class="tt-dataset-packages"></div></span></span>

        </div>
    </form>
    <h1>
        <a id="npm-logo" href="https://www.npmjs.org/">
            <img src="img/npm.png" alt="npm">
        </a>
    </h1>
</header>


<div id="package">
<header>
    <h1>grunt-usemin</h1>

    <a href="https://www.npmjs.org/package/grunt-usemin#" class="star" title="click here to star/unstar this package"
       data-name="grunt-usemin"></a>
</header>


<p class="description">Replaces references to non-optimized scripts or stylesheets into a set of HTML files (or any
    templates/views).</p>


<pre class="sh sh_sourceCode"><code>npm install grunt<span class="sh_symbol">-</span>usemin</code></pre>


<span class="login-for-graphs">Want to see pretty graphs? <a
        href="https://www.npmjs.org/login?done=/package/grunt-usemin">Log in now!</a></span>

<table class="downloads">

    <tbody>
    <tr>
        <td>2 707</td>
        <td> downloads in the last day</td>
    </tr>
    <tr>
        <td>46 380</td>
        <td> downloads in the last week</td>
    </tr>
    <tr>
        <td>176 184</td>
        <td> downloads in the last month</td>
    </tr>
    </tbody>
</table>


<table class="metadata">

    <tbody>
    <tr>
        <th>Last Published By</th>
        <td>
            <div class="user">
                <a class="username" href="https://www.npmjs.org/~sindresorhus"><img
                        src="img/d36a92237c75c5337c17b60d90686bf9" class="avatar">
                    sindresorhus</a>
            </div>
        </td>
    </tr>


    <tr>
        <th>Maintainers</th>
        <td>

            <div class="user">
                <a class="username" href="https://www.npmjs.org/~sindresorhus"><img
                        src="img/d36a92237c75c5337c17b60d90686bf9" class="avatar">
                    sindresorhus</a>
            </div>

            <div class="user">
                <a class="username" href="https://www.npmjs.org/~sleeper"><img
                        src="img/4605de69c4c3af3f48b8e829206cd4c2" class="avatar">
                    sleeper</a>
            </div>

            <div class="user">
                <a class="username" href="https://www.npmjs.org/~paulirish"><img
                        src="img/ffe68d6f71b225f7661d33f2a8908281" class="avatar">
                    paulirish</a>
            </div>

            <div class="user">
                <a class="username" href="https://www.npmjs.org/~addyosmani"><img
                        src="img/96270e4c3e5e9806cf7245475c00b275" class="avatar">
                    addyosmani</a>
            </div>

            <div class="user">
                <a class="username" href="https://www.npmjs.org/~passy"><img src="img/be451fcdbf0e5ff07f23ed16cb5c90a3?__inline"
                                                                             class="avatar">
                    passy</a>
            </div>

            <div class="user">
                <a class="username" href="https://www.npmjs.org/~sboudrias"><img
                        src="img/368346708a485060d31f77677a21d2a5" class="avatar">
                    sboudrias</a>
            </div>

            <div class="user">
                <a class="username" href="https://www.npmjs.org/~eddiemonge"><img
                        src="img/fd76f6b17f0388422320c9dabe619a72" class="avatar">
                    eddiemonge</a>
            </div>

        </td>
    </tr>

    <tr>
        <th>Version</th>
        <td>
            <b>
                2.6.0
            </b>

            last updated
            7 days ago

        </td>
    </tr>

    <tr>
        <th>License</th>
        <td>
            <a href="http://opensource.org/licenses/BSD-2-Clause">BSD-2-Clause</a>
        </td>
    </tr>


    <tr>
        <th>Keywords</th>
        <td><a href="https://www.npmjs.org/browse/keyword/gruntplugin">gruntplugin</a>, <a
                href="https://www.npmjs.org/browse/keyword/usemin">usemin</a>, <a
                href="https://www.npmjs.org/browse/keyword/yeoman">yeoman</a>, <a
                href="https://www.npmjs.org/browse/keyword/html">html</a>, <a
                href="https://www.npmjs.org/browse/keyword/css">css</a>, <a
                href="https://www.npmjs.org/browse/keyword/optimize">optimize</a></td>
    </tr>


    <tr>
        <th>Repository</th>
        <td>
            <a href="https://github.com/yeoman/grunt-usemin">
                https://github.com/yeoman/grunt-usemin.git</a>
            (git)
        </td>
    </tr>


    <tr>
        <th>Homepage</th>
        <td>
            <a href="https://github.com/yeoman/grunt-usemin">https://github.com/yeoman/grunt-usemin</a>
        </td>
    </tr>


    <tr>
        <th>Bugs</th>
        <td>
            <a href="https://github.com/yeoman/grunt-usemin/issues">https://github.com/yeoman/grunt-usemin/issues</a>
        </td>
    </tr>

    <tr>

        <th>Dependencies</th>
        <td>

            <a href="https://www.npmjs.org/package/chalk">chalk</a>,
            <a href="https://www.npmjs.org/package/debug">debug</a>,
            <a href="https://www.npmjs.org/package/lodash">lodash</a>
        </td>
    </tr>

    <tr>
        <th>Dependents (7)</th>
        <td>
            <a href="https://www.npmjs.org/package/bhargav">bhargav</a>, <a
                href="https://www.npmjs.org/package/curvechart">curvechart</a>, <a
                href="https://www.npmjs.org/package/doll">doll</a>, <a
                href="https://www.npmjs.org/package/generator-admo">generator-admo</a>, <a
                href="https://www.npmjs.org/package/genesis-skeleton">genesis-skeleton</a>, <a
                href="https://www.npmjs.org/package/grasshopper-admin">grasshopper-admin</a>, <a
                href="https://www.npmjs.org/package/harika">harika</a>
        </td>
    </tr>


    <tr>
        <th>Starred by (12)</th>
        <td>
            <a href="https://www.npmjs.org/~ain">ain</a>, <a href="https://www.npmjs.org/~bargaorobalo">bargaorobalo</a>,
            <a href="https://www.npmjs.org/~chyingp">chyingp</a>, <a href="https://www.npmjs.org/~jmav">jmav</a>, <a
                href="https://www.npmjs.org/~juniorconte">juniorconte</a>, <a href="https://www.npmjs.org/~leesei">leesei</a>,
            <a href="https://www.npmjs.org/~martinlancer">martinlancer</a>, <a
                href="https://www.npmjs.org/~nosch">nosch</a>, <a href="https://www.npmjs.org/~passy">passy</a>, <a
                href="https://www.npmjs.org/~skibblenybbles">skibblenybbles</a>, <a href="https://www.npmjs.org/~tsm91">tsm91</a>,
            <a href="https://www.npmjs.org/~vladbadea">vladbadea</a>
        </td>
    </tr>

    </tbody>
</table>

<div class="details">
<ul class="toc">

    <li><a href="https://www.npmjs.org/package/grunt-usemin#readme">Read Me</a></li>

</ul>


<section id="readme">
<h1 id="grunt-usemin-build-status-https-secure-travis-ci-org-yeoman-grunt-usemin-svg-branch-master-http-travis-ci-org-yeoman-grunt-usemin-">
    grunt-usemin <a href="http://travis-ci.org/yeoman/grunt-usemin"><img src="img/grunt-usemin.svg" alt="Build Status"></a>
</h1>
<blockquote>
    <p>Replaces references from non-optimized scripts, stylesheets and other assets to their optimized version within a
        set of HTML files (or any templates/views).</p>
</blockquote>
<p><strong><a href="https://github.com/yeoman/grunt-usemin/issues/313">Maintainer wanted</a></strong></p>

<h2 id="getting-started">Getting Started</h2>

<p>If you haven't used <a href="http://gruntjs.com/">grunt</a> before, be sure to check out the <a
        href="http://gruntjs.com/getting-started">Getting Started</a> guide, as it explains how to create a <a
        href="http://gruntjs.com/getting-started">gruntfile</a> as well as install and use grunt plugins. Once you're
    familiar with that process, install this plugin with this command:</p>
<pre class="sh_sourceCode"><code class="lang-shell">npm install grunt<span class="sh_symbol">-</span>usemin <span
        class="sh_symbol">--</span>save<span class="sh_symbol">-</span>dev
</code></pre>
<h2 id="tasks">Tasks</h2>

<p><code>usemin</code> replaces the references of scripts, stylesheets and other assets within HTML files dynamically
    with optimized versions of them. To do this <code>usemin</code> exports 2 built-in tasks called
    <code>useminPrepare</code> and <code>usemin</code> and utilizes a couple of other Grunt plugins for the optimization
    process. <code>usemin</code> does this by generating the subtasks for these Grunt plugins dynamically.</p>

<p>The built-in tasks of <code>usemin</code>:</p>
<ul>
    <li><code>useminPrepare</code> prepares the configuration to transform specific blocks in the scrutinized file into
        a single line, targeting an optimized version of the files. This is done by generating subtasks called <code>generated</code>
        for every optimization steps handled by the Grunt plugins listed below.
    </li>
    <li><code>usemin</code> replaces the blocks by the file they reference, and replaces all references to assets by
        their revisioned version if it is found on the disk. This target modifies the files it is working on.
    </li>
</ul>
<p>Grunt plugins which <code>usemin</code> can use to optimize files:</p>
<ul>
    <li><a href="https://github.com/gruntjs/grunt-contrib-concat"><code>concat</code></a> concatenates files (usually JS
        or CSS).
    </li>
    <li><a href="https://github.com/gruntjs/grunt-contrib-uglify"><code>uglify</code></a> minifies JS files.</li>
    <li><a href="https://github.com/gruntjs/grunt-contrib-cssmin"><code>cssmin</code></a> minifies CSS files.</li>
    <li><a href="https://github.com/yeoman/grunt-filerev"><code>filerev</code></a> revisions static assets through a
        file content hash.
    </li>
</ul>
<p>To install required plugins, run:</p>
<pre class="sh_sourceCode"><code>npm install grunt<span class="sh_symbol">-</span>contrib<span
        class="sh_symbol">-</span>concat grunt<span class="sh_symbol">-</span>contrib<span class="sh_symbol">-</span>uglify
    grunt<span class="sh_symbol">-</span>contrib<span class="sh_symbol">-</span>cssmin grunt<span
            class="sh_symbol">-</span>filerev <span class="sh_symbol">--</span>save
</code></pre>
<p><strong>Important</strong>: <em>You still need to manually install and load these dependencies</em>.</p>

<p>In a typical <code>usemin</code> setup you launch <code>useminPrepare</code> first, then call every optimization step
    you want through their <code>generated</code> subtask and call <code>usemin</code> in the end. It could look like
    this:</p>
<pre class="sh_sourceCode"><code class="lang-js"><span class="sh_comment">// simple build task</span>
    grunt<span class="sh_symbol">.</span><span class="sh_function">registerTask</span><span
            class="sh_symbol">(</span><span class="sh_string">'build'</span><span class="sh_symbol">,</span> <span
            class="sh_symbol">[</span>
    <span class="sh_string">'useminPrepare'</span><span class="sh_symbol">,</span>
    <span class="sh_string">'concat:generated'</span><span class="sh_symbol">,</span>
    <span class="sh_string">'cssmin:generated'</span><span class="sh_symbol">,</span>
    <span class="sh_string">'uglify:generated'</span><span class="sh_symbol">,</span>
    <span class="sh_string">'filerev'</span><span class="sh_symbol">,</span>
    <span class="sh_string">'usemin'</span>
    <span class="sh_symbol">]);</span>
</code></pre>
<h2 id="the-useminprepare-task">The useminPrepare task</h2>

<p><code>useminPrepare</code> task updates the grunt configuration to apply a configured transformation flow to tagged
    files (i.e. blocks).
    By default the transformation flow is composed of <code>concat</code> and <code>uglifyjs</code> for JS files, but it
    can be configured.</p>

<h3 id="blocks">Blocks</h3>

<p>Blocks are expressed as:</p>
<pre class="sh_sourceCode"><code class="lang-html"><span class="sh_symbol">&lt;!--</span> build<span class="sh_symbol">:&lt;</span>type<span
        class="sh_symbol">&gt;(</span>alternate search path<span class="sh_symbol">)</span> <span
        class="sh_symbol">&lt;</span>path<span class="sh_symbol">&gt;</span> <span class="sh_symbol">--&gt;</span>
    <span class="sh_symbol">...</span> HTML Markup<span class="sh_symbol">,</span> list of <span class="sh_normal">script </span><span
            class="sh_symbol">/</span> link tags<span class="sh_symbol">.</span>
    <span class="sh_symbol">&lt;!--</span> endbuild <span class="sh_symbol">--&gt;</span>
</code></pre>
<ul>
    <li><strong>type</strong>: can be <code>js</code>, <code>css</code> or a custom type with a <a
            href="https://github.com/yeoman/grunt-usemin#blockreplacements">block replacement function</a> defined
        <ul>
            <li>If another type, the block will be ignored. Useful for "development only" blocks that won't appear in
                your build
            </li>
        </ul>
    </li>
    <li><strong>alternate search path</strong>: (optional) By default the input files are relative to the treated file.
        Alternate search path allows one to change that
    </li>
    <li><strong>path</strong>: the file path of the optimized file, the target output</li>
</ul>
<p>An example of this in completed form can be seen below:</p>
<pre class="sh_sourceCode"><code class="lang-html"><span class="sh_symbol">&lt;!--</span> build<span
        class="sh_symbol">:</span>js <span class="sh_normal">js</span><span class="sh_symbol">/</span>app<span
        class="sh_symbol">.</span>js <span class="sh_symbol">--&gt;</span>
    <span class="sh_symbol">&lt;</span>script src<span class="sh_symbol">=</span><span
            class="sh_string">"js/app.js"</span><span class="sh_symbol">&gt;&lt;/</span>script<span class="sh_symbol">&gt;</span>
    <span class="sh_symbol">&lt;</span>script src<span class="sh_symbol">=</span><span class="sh_string">"js/controllers/thing-controller.js"</span><span
            class="sh_symbol">&gt;&lt;/</span>script<span class="sh_symbol">&gt;</span>
    <span class="sh_symbol">&lt;</span>script src<span class="sh_symbol">=</span><span class="sh_string">"js/models/thing-model.js"</span><span
            class="sh_symbol">&gt;&lt;/</span>script<span class="sh_symbol">&gt;</span>
    <span class="sh_symbol">&lt;</span>script src<span class="sh_symbol">=</span><span class="sh_string">"js/views/thing-view.js"</span><span
            class="sh_symbol">&gt;&lt;/</span>script<span class="sh_symbol">&gt;</span>
    <span class="sh_symbol">&lt;!--</span> endbuild <span class="sh_symbol">--&gt;</span>
</code></pre>
<h3 id="transformation-flow">Transformation flow</h3>

<p>The transformation flow is made of sequential steps: each of the steps transform the file, and useminPrepare will
    modify the configuration in order for the described steps to be correctly performed.</p>

<p>By default the flow is: <code>concat -&gt; uglifyjs</code>.
    Additionally to the flow, at the end, some postprocessors can be launched to further alter the configuration.</p>

<p>Let's have an example, using the default flow (we're just going to look at the steps), <code>app</code> for input
    dir, <code>dist</code> for output dir, and the following block:</p>
<pre class="sh_sourceCode"><code class="lang-html"><span class="sh_symbol">&lt;!--</span> build<span
        class="sh_symbol">:</span>js <span class="sh_normal">js</span><span class="sh_symbol">/</span>app<span
        class="sh_symbol">.</span>js <span class="sh_symbol">--&gt;</span>
    <span class="sh_symbol">&lt;</span>script src<span class="sh_symbol">=</span><span
            class="sh_string">"js/app.js"</span><span class="sh_symbol">&gt;&lt;/</span>script<span class="sh_symbol">&gt;</span>
    <span class="sh_symbol">&lt;</span>script src<span class="sh_symbol">=</span><span class="sh_string">"js/controllers/thing-controller.js"</span><span
            class="sh_symbol">&gt;&lt;/</span>script<span class="sh_symbol">&gt;</span>
    <span class="sh_symbol">&lt;</span>script src<span class="sh_symbol">=</span><span class="sh_string">"js/models/thing-model.js"</span><span
            class="sh_symbol">&gt;&lt;/</span>script<span class="sh_symbol">&gt;</span>
    <span class="sh_symbol">&lt;</span>script src<span class="sh_symbol">=</span><span class="sh_string">"js/views/thing-view.js"</span><span
            class="sh_symbol">&gt;&lt;/</span>script<span class="sh_symbol">&gt;</span>
    <span class="sh_symbol">&lt;!--</span> endbuild <span class="sh_symbol">--&gt;</span>
</code></pre>
<p>The produced configuration will look like:</p>
<pre class="sh_sourceCode"><code class="lang-js"><span class="sh_cbracket">{</span>
    concat<span class="sh_symbol">:</span> <span class="sh_cbracket">{</span>
    generated<span class="sh_symbol">:</span> <span class="sh_cbracket">{</span>
    files<span class="sh_symbol">:</span> <span class="sh_symbol">[</span>
    <span class="sh_cbracket">{</span>
    dest<span class="sh_symbol">:</span> <span class="sh_string">'.tmp/concat/js/app.js'</span><span
            class="sh_symbol">,</span>
    src<span class="sh_symbol">:</span> <span class="sh_symbol">[</span>
    <span class="sh_string">'app/js/app.js'</span><span class="sh_symbol">,</span>
    <span class="sh_string">'app/js/controllers/thing-controller.js'</span><span class="sh_symbol">,</span>
    <span class="sh_string">'app/js/models/thing-model.js'</span><span class="sh_symbol">,</span>
    <span class="sh_string">'app/js/views/thing-view.js'</span>
    <span class="sh_symbol">]</span>
    <span class="sh_cbracket">}</span>
    <span class="sh_symbol">]</span>
    <span class="sh_cbracket">}</span>
    <span class="sh_cbracket">}</span><span class="sh_symbol">,</span>
    uglify<span class="sh_symbol">:</span> <span class="sh_cbracket">{</span>
    generated<span class="sh_symbol">:</span> <span class="sh_cbracket">{</span>
    files<span class="sh_symbol">:</span> <span class="sh_symbol">[</span>
    <span class="sh_cbracket">{</span>
    dest<span class="sh_symbol">:</span> <span class="sh_string">'dist/js/app.js'</span><span class="sh_symbol">,</span>
    src<span class="sh_symbol">:</span> <span class="sh_symbol">[</span> <span
            class="sh_string">'.tmp/concat/js/app.js'</span> <span class="sh_symbol">]</span>
    <span class="sh_cbracket">}</span>
    <span class="sh_symbol">]</span>
    <span class="sh_cbracket">}</span>
    <span class="sh_cbracket">}</span>
    <span class="sh_cbracket">}</span>
</code></pre>
<h3 id="directories">Directories</h3>

<p>Internally, the task parses your HTML markup to find each of these blocks, and initializes the corresponding Grunt
    config for the concat / uglify tasks when <code>type=js</code>, the concat / cssmin tasks when <code>type=css</code>.
</p>

<p>One doesn't need to specify a concat/uglify/cssmin configuration anymore.</p>

<p>It uses only one target: <code>html</code>, with a list of the concerned files. For example, in your <code>Gruntfile.js</code>:
</p>

<p>By default, it will consider the directory where the looked-at file is located as the 'root' filesystem. Each
    relative path (for example to a javascript file) will be resolved from this path. Same goes for the absolute ones.
    If you need to change the 'root' dir, use the <code>root</code> option (see below).</p>
<pre class="sh_sourceCode"><code class="lang-js">useminPrepare<span class="sh_symbol">:</span> <span
        class="sh_cbracket">{</span>
    html<span class="sh_symbol">:</span> <span class="sh_string">'index.html'</span>
    <span class="sh_cbracket">}</span>
</code></pre>
<p>Targets can also be configured using the grunt src-dest files syntax <a
        href="http://gruntjs.com/configuring-tasks#files">http://gruntjs.com/configuring-tasks#files</a>, e.g.</p>
<pre class="sh_sourceCode"><code class="lang-js">useminPrepare<span class="sh_symbol">:</span> <span
        class="sh_cbracket">{</span>
    foo<span class="sh_symbol">:</span> <span class="sh_cbracket">{</span>
    src<span class="sh_symbol">:</span> <span class="sh_symbol">[</span><span class="sh_string">'index.html'</span><span
            class="sh_symbol">,</span> <span class="sh_string">'another.html'</span><span class="sh_symbol">]</span>
    <span class="sh_cbracket">}</span><span class="sh_symbol">,</span>
    bar<span class="sh_symbol">:</span> <span class="sh_cbracket">{</span>
    src<span class="sh_symbol">:</span> <span class="sh_string">'index.html'</span>
    <span class="sh_cbracket">}</span>
    <span class="sh_cbracket">}</span>
</code></pre>
<h3 id="options">Options</h3>

<h3 id="dest">dest</h3>

<p>Type: 'string'<br>Default: <code>nil</code></p>

<p>Base directory where the transformed files should be output.</p>

<h3 id="staging">staging</h3>

<p>Type: 'string'<br>Default: <code>.tmp</code></p>

<p>Base directory where the temporary files should be output (e.g. concatenated files).</p>

<h3 id="root">root</h3>

<p>Type: 'string' or 'Array'<br>Default: <code>nil</code></p>

<p>The root directory from which your files will be resolved.</p>

<h3 id="flow">flow</h3>

<p>Type: 'object'<br>Default: <code>{ steps: { js: ['concat', 'uglifyjs'], css: ['concat', 'cssmin'] }, post: {}
    }</code></p>

<p>This allow you to configure the workflow, either on a per-target basis, or for all the targets.
    You can change the <code>steps</code> or the post-processors (<code>post</code>) separately.</p>

<p>For example:</p>
<ul>
    <li>to change the <code>js</code> <code>steps</code> and <code>post</code> for the target <code>html</code>:</li>
</ul>
<pre class="sh_sourceCode"><code class="lang-js">useminPrepare<span class="sh_symbol">:</span> <span
        class="sh_cbracket">{</span>
    html<span class="sh_symbol">:</span> <span class="sh_string">'index.html'</span><span class="sh_symbol">,</span>
    options<span class="sh_symbol">:</span> <span class="sh_cbracket">{</span>
    flow<span class="sh_symbol">:</span> <span class="sh_cbracket">{</span>
    html<span class="sh_symbol">:</span> <span class="sh_cbracket">{</span>
    steps<span class="sh_symbol">:</span> <span class="sh_cbracket">{</span>
    js<span class="sh_symbol">:</span> <span class="sh_symbol">[</span><span class="sh_string">'uglifyjs'</span><span
            class="sh_symbol">]</span>
    <span class="sh_cbracket">}</span><span class="sh_symbol">,</span>
    post<span class="sh_symbol">:</span> <span class="sh_cbracket">{}</span>
    <span class="sh_cbracket">}</span>
    <span class="sh_cbracket">}</span>
    <span class="sh_cbracket">}</span>
    <span class="sh_cbracket">}</span>
</code></pre>
<ul>
    <li>to change the <code>js</code> <code>steps</code> and <code>post</code> for all targets:</li>
</ul>
<pre class="sh_sourceCode"><code class="lang-js">useminPrepare<span class="sh_symbol">:</span> <span
        class="sh_cbracket">{</span>
    html<span class="sh_symbol">:</span> <span class="sh_string">'index.html'</span><span class="sh_symbol">,</span>
    options<span class="sh_symbol">:</span> <span class="sh_cbracket">{</span>
    flow<span class="sh_symbol">:</span> <span class="sh_cbracket">{</span>
    steps<span class="sh_symbol">:</span> <span class="sh_cbracket">{</span>
    js<span class="sh_symbol">:</span> <span class="sh_symbol">[</span><span class="sh_string">'uglifyjs'</span><span
            class="sh_symbol">]</span>
    <span class="sh_cbracket">}</span><span class="sh_symbol">,</span>
    post<span class="sh_symbol">:</span> <span class="sh_cbracket">{}</span>
    <span class="sh_cbracket">}</span>
    <span class="sh_cbracket">}</span>
    <span class="sh_cbracket">}</span>
</code></pre>
<ul>
    <li>to customize the generated configuration via post-processors:</li>
</ul>
<pre class="sh_sourceCode"><code class="lang-js">useminPrepare<span class="sh_symbol">:</span> <span
        class="sh_cbracket">{</span>
    html<span class="sh_symbol">:</span> <span class="sh_string">'index.html'</span><span class="sh_symbol">,</span>
    options<span class="sh_symbol">:</span> <span class="sh_cbracket">{</span>
    flow<span class="sh_symbol">:</span> <span class="sh_cbracket">{</span>
    steps<span class="sh_symbol">:</span> <span class="sh_cbracket">{</span>
    js<span class="sh_symbol">:</span> <span class="sh_symbol">[</span><span class="sh_string">'uglifyjs'</span><span
            class="sh_symbol">]</span>
    <span class="sh_cbracket">}</span><span class="sh_symbol">,</span>
    post<span class="sh_symbol">:</span> <span class="sh_cbracket">{</span>
    js<span class="sh_symbol">:</span> <span class="sh_symbol">[</span><span class="sh_cbracket">{</span>
    name<span class="sh_symbol">:</span> <span class="sh_string">'uglify'</span><span class="sh_symbol">,</span>
    createConfig<span class="sh_symbol">:</span> <span class="sh_keyword">function</span> <span
            class="sh_symbol">(</span>context<span class="sh_symbol">,</span> block<span class="sh_symbol">)</span>
    <span class="sh_cbracket">{</span>
    <span class="sh_keyword">var</span> generated <span class="sh_symbol">=</span> context<span
            class="sh_symbol">.</span>options<span class="sh_symbol">.</span>generated<span class="sh_symbol">;</span>
    generated<span class="sh_symbol">.</span>options <span class="sh_symbol">=</span> <span class="sh_cbracket">{</span>
    foo<span class="sh_symbol">:</span> <span class="sh_string">'bar'</span>
    <span class="sh_cbracket">}</span><span class="sh_symbol">;</span>
    <span class="sh_cbracket">}</span>
    <span class="sh_cbracket">}</span><span class="sh_symbol">]</span>
    <span class="sh_cbracket">}</span>
    <span class="sh_cbracket">}</span>
    <span class="sh_cbracket">}</span>
    <span class="sh_cbracket">}</span>
</code></pre>
<p>The given steps or post-processors may be specified as strings (for the default steps and post-processors), or as an
    object (for the user-defined ones).</p>
<h4 id="user-defined-steps-and-post-processors">User-defined steps and post-processors</h4>

<p>User-defined steps and post-processors must have 2 attributes:</p>
<ul>
    <li><code>name</code>: name of the <code>Gruntfile</code> attribute that holds the corresponding config</li>
    <li><code>createConfig</code> which is a 2 arguments function ( a <code>context</code> and the treated
        <code>block</code>)
    </li>
</ul>
<p>For an example of steps/post-processors, you can have a look at <code>concat</code> and <code>uglifyjs</code> in the
    <code>lib/config</code> directory of this repository.</p>
<h5 id="-createconfig-"><code>createConfig</code></h5>

<p>The <code>createConfig</code> function is responsible for creating (or updating) the configuration associated to the
    current step/post-processor.
    It takes 2 arguments ( a <code>context</code> and the treated <code>block</code>), and returns a configuration
    object.</p>
<h6 id="-context-"><code>context</code></h6>

<p>The <code>context</code> object represent the current context the step/post-processor is running in. As the
    step/post-processor is a step of a flow, it must be listed in the input files and directory it must write a
    configuration for, potentially the already existing configuration. It must also indicate to the other
    steps/post-processor which files it will output in which directory. All this information is held by the <code>context</code>
    object.
    Attributes:</p>
<ul>
    <li><code>inDir</code>: the directory where the <code>input</code> file for the step/post-processors will be</li>
    <li><code>inFiles</code>: the list of input file to take care of</li>
    <li><code>outDir</code>: where the files created by the step/post-processors will be</li>
    <li><code>outFiles</code>: the files that are going to be created</li>
    <li><code>last</code>: whether or not we're the last step of the flow</li>
    <li><code>options</code>: options of the <code>Gruntfile.js</code> for this step (e.g. if the step is named <code>foo</code>,
        holds configuration of the <code>Gruntfile.js</code> associated to the attribute <code>foo</code>)
    </li>
</ul>
<h6 id="-block-"><code>block</code></h6>

<p>The actual looked-at block, parsed an put in a structure.</p>

<p>Example:
    The following block</p>
<pre class="sh_sourceCode"><code class="lang-html"><span class="sh_symbol">&lt;!--</span> build<span
        class="sh_symbol">:</span>js <span class="sh_normal">scripts</span><span class="sh_symbol">/</span>site<span
        class="sh_symbol">.</span>js <span class="sh_symbol">--&gt;</span><span class="sh_string">',</span>
    <span class="sh_string">&lt;script src="foo.js"&gt;&lt;/script&gt;'</span><span class="sh_symbol">,</span>
    <span class="sh_symbol">&lt;</span>script src<span class="sh_symbol">=</span><span class="sh_string">"bar.js"</span><span
            class="sh_symbol">&gt;&lt;/</span>script<span class="sh_symbol">&gt;</span><span class="sh_string">',</span>
    <span class="sh_string">&lt;script src="baz.js"&gt;&lt;/script&gt;'</span><span class="sh_symbol">,</span>
    <span class="sh_symbol">&lt;!--</span> endbuild <span class="sh_symbol">--&gt;</span><span
            class="sh_string">'</span>
</code></pre>
<p>is parsed as, and given to <code>createConfig</code> as:</p>
<pre class="sh_sourceCode"><code class="lang-js"><span class="sh_keyword">var</span> block <span
        class="sh_symbol">=</span> <span class="sh_cbracket">{</span>
    type<span class="sh_symbol">:</span> <span class="sh_string">'js'</span><span class="sh_symbol">,</span>
    dest<span class="sh_symbol">:</span> <span class="sh_string">'scripts/site.js'</span><span
            class="sh_symbol">,</span>
    src<span class="sh_symbol">:</span> <span class="sh_symbol">[</span>
    <span class="sh_string">'foo.js'</span><span class="sh_symbol">,</span>
    <span class="sh_string">'bar.js'</span><span class="sh_symbol">,</span>
    <span class="sh_string">'baz.js'</span>
    <span class="sh_symbol">],</span>
    raw<span class="sh_symbol">:</span> <span class="sh_symbol">[</span>
    <span class="sh_string">'    &lt;!-- build:js scripts/site.js --&gt;'</span><span class="sh_symbol">,</span>
    <span class="sh_string">'    &lt;script src="foo.js"&gt;&lt;/script&gt;'</span><span class="sh_symbol">,</span>
    <span class="sh_string">'    &lt;script src="bar.js"&gt;&lt;/script&gt;'</span><span class="sh_symbol">,</span>
    <span class="sh_string">'    &lt;script src="baz.js"&gt;&lt;/script&gt;'</span><span class="sh_symbol">,</span>
    <span class="sh_string">'    &lt;!-- endbuild --&gt;'</span>
    <span class="sh_symbol">]</span>
    <span class="sh_cbracket">}</span><span class="sh_symbol">;</span>
</code></pre>
<h2 id="the-usemin-task">The usemin task</h2>

<p>The <code>usemin</code> task has 2 actions:</p>
<ul>
    <li>First it replaces all the blocks with a single "summary" line, pointing to a file creating by the transformation
        flow.
    </li>
    <li>Then it looks for references to assets (i.e. images, scripts, ...), and tries to replace them with their revved
        version if it can find one on disk
    </li>
</ul>
<h3 id="finding-assets">Finding assets</h3>

<p>By default <code>usemin</code> will look for a map object created by <a
        href="https://github.com/yeoman/grunt-filerev">grunt-filerev</a>, located in <code>grunt.filerev.summary</code>.
    If it does not find it it will revert to disk lookup which is longer.</p>

<p>Note that by using the <code>options.revmap</code> (see below), you can furnish a map object.</p>

<h3 id="on-directories">On directories</h3>

<p>When <code>usemin</code> tries to replace referenced assets with their revved version it has to look at a collection
    of directories (asset search paths): for each of the directories of this collection it will look at the below tree,
    and try to find the revved version.
    This asset search directories collection is by default set to the location of the file that is scrutinized but can
    be modified (see Options below).</p>
<h4 id="example-1-file-dist-html-index-html-has-the-following-content-">Example 1: file
    <code>dist/html/index.html</code> has the following content:</h4>
<pre class="sh_sourceCode"><code class="lang-html"><span class="sh_symbol">&lt;</span>link rel<span
        class="sh_symbol">=</span><span class="sh_string">"stylesheet"</span> href<span class="sh_symbol">=</span><span
        class="sh_string">"styles/main.css"</span><span class="sh_symbol">&gt;</span>
    <span class="sh_symbol">&lt;</span>img src<span class="sh_symbol">=</span><span class="sh_string">"../images/test.png"</span><span
            class="sh_symbol">&gt;</span>
</code></pre>
<p>By default <code>usemin</code> will look under <code>dist/html</code> for revved versions of:</p>
<ul>
    <li><code>styles/main.css</code>: a revved version of <code>main.css</code> will be looked at under the <code>dist/html/styles</code>
        directory. For example a file <code>dist/html/styles/main.1234.css</code> will match (although <code>dist/html/main.1234.css</code>
        won't: the path of the referenced file is important)
    </li>
    <li><code>../images/test.png</code>: it basically means that a revved version of <code>test.png</code> will be
        looked for under the <code>dist/images</code> directory
    </li>
</ul>
<h4 id="example-2-file-dist-html-index-html-has-the-following-content-">Example 2: file
    <code>dist/html/index.html</code> has the following content:</h4>
<pre class="sh_sourceCode"><code class="lang-html"><span class="sh_symbol">&lt;</span>link rel<span
        class="sh_symbol">=</span><span class="sh_string">"stylesheet"</span> href<span class="sh_symbol">=</span><span
        class="sh_string">"/styles/main.css"</span><span class="sh_symbol">&gt;</span>
    <span class="sh_symbol">&lt;</span>img src<span class="sh_symbol">=</span><span
            class="sh_string">"/images/test.png"</span><span class="sh_symbol">&gt;</span>
</code></pre>
<p>By default <code>usemin</code> will look under <code>dist/html</code> for revved versions of
    <code>styles/main.css</code> and <code>images/test.png</code>. Now let's suppose our assets are scattered in <code>dist/assets</code>.
    By changing the asset search path list to <code>['dist/assets']</code>, the revved versions of the files will be
    searched for under <code>dist/assets</code> (and thus, for example, <code>dist/assets/images/test.875487.png</code>
    and <code>dist/assets/styles/main.98090.css</code>) will be found.</p>

<h3 id="options">Options</h3>
<h4 id="assetsdirs">assetsDirs</h4>

<p>Type: 'Array'<br>Default: Single item array set to the value of the directory where the currently looked at file is.
</p>

<p>List of directories where we should start to look for revved version of the assets referenced in the currently looked
    at file.</p>

<p>Example:</p>
<pre class="sh_sourceCode"><code class="lang-js">usemin<span class="sh_symbol">:</span> <span
        class="sh_cbracket">{</span>
    html<span class="sh_symbol">:</span> <span class="sh_string">'build/index.html'</span><span
            class="sh_symbol">,</span>
    options<span class="sh_symbol">:</span> <span class="sh_cbracket">{</span>
    assetsDirs<span class="sh_symbol">:</span> <span class="sh_symbol">[</span><span
            class="sh_string">'foo/bar'</span><span class="sh_symbol">,</span> <span class="sh_string">'bar'</span><span
            class="sh_symbol">]</span>
    <span class="sh_cbracket">}</span>
    <span class="sh_cbracket">}</span>
</code></pre>
<h4 id="patterns">patterns</h4>

<p>Type: 'Object'<br>Default: Empty</p>

<p>Allows for user defined pattern to replace reference to files. For example, let's suppose that you want to replace
    all references to <code>'image.png'</code> in your Javascript files by the revved version of <code>image.png</code>
    found below the directory <code>images</code>.
    By specifying something along the lines of:</p>
<pre class="sh_sourceCode"><code class="lang-js">usemin<span class="sh_symbol">:</span> <span
        class="sh_cbracket">{</span>
    js<span class="sh_symbol">:</span> <span class="sh_string">'*.js'</span><span class="sh_symbol">,</span>
    options<span class="sh_symbol">:</span> <span class="sh_cbracket">{</span>
    assetsDirs<span class="sh_symbol">:</span> <span class="sh_string">'images'</span><span class="sh_symbol">,</span>
    patterns<span class="sh_symbol">:</span> <span class="sh_cbracket">{</span>
    js<span class="sh_symbol">:</span> <span class="sh_symbol">[</span>
    <span class="sh_symbol">[</span><span class="sh_regexp">/(image\.png)/</span><span class="sh_symbol">,</span> <span
            class="sh_string">'Replacing reference to image.png'</span><span class="sh_symbol">]</span>
    <span class="sh_symbol">]</span>
    <span class="sh_cbracket">}</span>
    <span class="sh_cbracket">}</span>
    <span class="sh_cbracket">}</span>
</code></pre>
<p>So in short:</p>
<ul>
    <li>key in pattern should match the target (e.g <code>js</code> key for the target <code>js</code>)</li>
    <li>Each pattern is an array of arrays. These arrays are composed of 4 items (last 2 are optional):
        <ul>
            <li>First one if the regexp to use. The first group is the one that is supposed to represent the file
                reference to replace
            </li>
            <li>Second one is a logging string
                <ul>
                    <li>FIXME</li>
                    <li>FIXME</li>
                </ul>
            </li>
        </ul>
    </li>
</ul>
<h4 id="blockreplacements">blockReplacements</h4>

<p>Type: 'Object'<br>Default: <code>{ css: function (block) { ... }, js: function (block) { ... } }</code></p>

<p>This lets you define how blocks get their content replaced. Useful to have block types other that <code>css</code>
    and <code>js</code>.</p>
<ul>
    <li>Object key matches a block type</li>
    <li>Value is the replacement function for that block type.
        <ul>
            <li>The replacement function gets called with a single argument: a <a
                    href="https://github.com/yeoman/grunt-usemin#block">block</a> object.
            </li>
            <li>Must return a <code>String</code>, the "summary" line that will replace the block content.</li>
        </ul>
    </li>
</ul>
<p>For example, to create a <code>less</code> block you could define its replacement function like this:</p>
<pre class="sh_sourceCode"><code class="lang-js">usemin<span class="sh_symbol">:</span> <span
        class="sh_cbracket">{</span>
    html<span class="sh_symbol">:</span> <span class="sh_string">'index.html'</span><span class="sh_symbol">,</span>
    options<span class="sh_symbol">:</span> <span class="sh_cbracket">{</span>
    blockReplacements<span class="sh_symbol">:</span> <span class="sh_cbracket">{</span>
    less<span class="sh_symbol">:</span> <span class="sh_keyword">function</span> <span
            class="sh_symbol">(</span>block<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
    <span class="sh_keyword">return</span> <span class="sh_string">'&lt;link rel="stylesheet" href="'</span> <span
            class="sh_symbol">+</span> block<span class="sh_symbol">.</span>dest <span class="sh_symbol">+</span> <span
            class="sh_string">'"&gt;'</span><span class="sh_symbol">;</span>
    <span class="sh_cbracket">}</span>
    <span class="sh_cbracket">}</span>
    <span class="sh_cbracket">}</span>
    <span class="sh_cbracket">}</span>
</code></pre>
<h4 id="revmap">revmap</h4>

<p>Type: 'String'<br>Default: Empty</p>

<p>Indicate the location of a map file, as produced by <code>grunt-filerev</code> for example. This map file is a simple
    JSON file, holding an object
    which attributes are the original file and associated value is the transformed file. For example:</p>
<pre class="sh_sourceCode"><code class="lang-js"><span class="sh_cbracket">{</span>
    <span class="sh_string">"foo.png"</span><span class="sh_symbol">:</span> <span
            class="sh_string">"foo.1234.png"</span>
    <span class="sh_cbracket">}</span>
</code></pre>
<p>This map will be used instead of looking for file on the disk.</p>

<h2 id="on-directories">On directories</h2>

<p>The main difference to be kept in mind, regarding directories and tasks, is that for <code>useminPrepare</code>, the
    directories needs to indicate the input,
    transient and output path needed to output the right configuration for the processors pipeline,
    whereas in the case of <code>usemin</code> it only reflects the output paths, as all the needed assets should have
    been output to the destination dir (either transformed or just copied)</p>

<h3 id="useminprepare">useminPrepare</h3>

<p><code>useminPrepare</code> is trying to prepare the right configuration for the pipeline of actions that are going to
    be
    applied on the blocks (for example concatenation and uglify-cation). As such it needs to have the input
    directory, temporary directories (staging) and destination directory.
    The files referenced in the block are either absolute or relative (<code>/images/foo.png</code> or <code>../../images/foo.png</code>).
    Absolute files references are looked in a given set of search path (input), which by default is set
    to the directory where the html/css file examined is located (can be overridden per block, or more
    generally through <code>root</code> option).
    Relative files references are also looked at from location of the examined file, unless stated otherwise.</p>

<h3 id="usemin">usemin</h3>

<p><code>usemin</code> target replaces references to images, scripts, css, ... in the furnished files (html, css, ...).
    These references may be either absolute (i.e. <code>/images/foo.png</code>) or relative (i.e.
    <code>image/foo.png</code>
    or <code>../images/foo.png</code>).
    When the reference is absolute a set of asset search paths should be looked at under the
    destination directory (for example, using the previous example, and <code>searchpath</code>
    equal to <code>['assets']</code>, <code>usemin</code> would try to find either a revved version of the image
    of the image below the <code>assets</code> directory: for example <code>dest/assets/images/foo.1223443.png</code>).
    When the reference is relative, by default the referenced item is looked in the path
    relative <em>to the current file location</em> in the destination directory (e.g. with the
    preceding example, if the file is <code>build/bar/index.html</code>, then transformed <code>index.html</code>
    will be in <code>dist/bar</code>, and <code>usemin</code> will look for
    <code>dist/bar/../images/foo.32323.png</code>).</p>

<h2 id="use-cases">Use cases</h2>

<h3 id="simple-one">Simple one</h3>
<pre class="sh_sourceCode"><code><span class="sh_symbol">|</span>
    <span class="sh_symbol">+-</span> app
    <span class="sh_symbol">|</span> <span class="sh_symbol">+-</span> index<span class="sh_symbol">.</span>html
    <span class="sh_symbol">|</span> <span class="sh_symbol">+-</span> assets
    <span class="sh_symbol">|</span> <span class="sh_symbol">+-</span> js
    <span class="sh_symbol">|</span> <span class="sh_symbol">+-</span> foo<span class="sh_symbol">.</span>js
    <span class="sh_symbol">|</span> <span class="sh_symbol">+-</span> bar<span class="sh_symbol">.</span>js
    <span class="sh_symbol">+-</span> dist
</code></pre>
<p>We want to optimize <code>foo.js</code> and <code>bar.js</code> into <code>optimized.js</code>, referenced using
    relative path. <code>index.html</code> should contain the following block:</p>
<pre class="sh_sourceCode"><code class="lang-html"><span class="sh_symbol">&lt;!--</span> build<span
        class="sh_symbol">:</span>js <span class="sh_normal">assets</span><span class="sh_symbol">/</span><span
        class="sh_normal">js</span><span class="sh_symbol">/</span>optimized<span class="sh_symbol">.</span>js <span
        class="sh_symbol">--&gt;</span>
    <span class="sh_symbol">&lt;</span>script src<span class="sh_symbol">=</span><span class="sh_string">"assets/js/foo.js"</span><span
            class="sh_symbol">&gt;&lt;/</span>script<span class="sh_symbol">&gt;</span>
    <span class="sh_symbol">&lt;</span>script src<span class="sh_symbol">=</span><span class="sh_string">"assets/js/bar.js"</span><span
            class="sh_symbol">&gt;&lt;/</span>script<span class="sh_symbol">&gt;</span>
    <span class="sh_symbol">&lt;!--</span> endbuild <span class="sh_symbol">--&gt;</span>
</code></pre>
<p>We want our files to be generated in the <code>dist</code> directory.</p>

<p>By using the following <code>useminPrepare</code> config:</p>
<pre class="sh_sourceCode"><code class="lang-js"><span class="sh_cbracket">{</span>
    useminPrepare<span class="sh_symbol">:</span> <span class="sh_cbracket">{</span>
    html<span class="sh_symbol">:</span> <span class="sh_string">'app/index.html'</span><span class="sh_symbol">,</span>
    options<span class="sh_symbol">:</span> <span class="sh_cbracket">{</span>
    dest<span class="sh_symbol">:</span> <span class="sh_string">'dist'</span>
    <span class="sh_cbracket">}</span>
    <span class="sh_cbracket">}</span>
    <span class="sh_cbracket">}</span>
</code></pre>
<p>This will, on the fly, generate the following configuration:</p>
<pre class="sh_sourceCode"><code class="lang-js"><span class="sh_cbracket">{</span>
    concat<span class="sh_symbol">:</span>
    <span class="sh_cbracket">{</span>
    <span class="sh_string">'.tmp/concat/assets/js/optimized.js'</span><span class="sh_symbol">:</span> <span
            class="sh_symbol">[</span>
    <span class="sh_string">'app/assets/js/foo.js'</span><span class="sh_symbol">,</span>
    <span class="sh_string">'app/assets/js/bar.js'</span>
    <span class="sh_symbol">]</span>
    <span class="sh_cbracket">}</span><span class="sh_symbol">,</span>

    uglify<span class="sh_symbol">:</span>
    <span class="sh_cbracket">{</span>
    <span class="sh_string">'dist/assets/js/optimized.js'</span><span class="sh_symbol">:</span> <span
            class="sh_symbol">[</span><span class="sh_string">'.tmp/concat/assets/js/optimized.js'</span><span
            class="sh_symbol">]</span>
    <span class="sh_cbracket">}</span>
    <span class="sh_cbracket">}</span>
</code></pre>
<h3 id="html-file-and-asset-files-in-sibling-directories">HTML file and asset files in sibling directories</h3>
<pre class="sh_sourceCode"><code>app
    <span class="sh_symbol">|</span>
    <span class="sh_symbol">+-</span> html
    <span class="sh_symbol">|</span> <span class="sh_symbol">+-</span> index<span class="sh_symbol">.</span>html
    <span class="sh_symbol">+-</span> assets
    <span class="sh_symbol">|</span> <span class="sh_symbol">+-</span> js
    <span class="sh_symbol">|</span> <span class="sh_symbol">+-</span> foo<span class="sh_symbol">.</span>js
    <span class="sh_symbol">|</span> <span class="sh_symbol">+-</span> bar<span class="sh_symbol">.</span>js
    <span class="sh_symbol">+-</span> dist
</code></pre>
<p>We want to optimize <code>foo.js</code> and <code>bar.js</code> into <code>optimized.js</code>, referenced using
    absolute path. <code>index.html</code> should contain the following block:</p>
<pre class="sh_sourceCode"><code class="lang-html"><span class="sh_symbol">&lt;!--</span> build<span
        class="sh_symbol">:</span><span class="sh_normal">js </span><span class="sh_symbol">/</span><span
        class="sh_normal">assets</span><span class="sh_symbol">/</span><span class="sh_normal">js</span><span
        class="sh_symbol">/</span>optimized<span class="sh_symbol">.</span>js <span class="sh_symbol">--&gt;</span>
    <span class="sh_symbol">&lt;</span>script src<span class="sh_symbol">=</span><span class="sh_string">"/assets/js/foo.js"</span><span
            class="sh_symbol">&gt;&lt;/</span>script<span class="sh_symbol">&gt;</span>
    <span class="sh_symbol">&lt;</span>script src<span class="sh_symbol">=</span><span class="sh_string">"/assets/js/bar.js"</span><span
            class="sh_symbol">&gt;&lt;/</span>script<span class="sh_symbol">&gt;</span>
    <span class="sh_symbol">&lt;!--</span> endbuild <span class="sh_symbol">--&gt;</span>
</code></pre>
<p>We want our files to be generated in the <code>dist</code> directory.</p>

<p>By using the following <code>useminPrepare</code> config:</p>
<pre class="sh_sourceCode"><code class="lang-js"><span class="sh_cbracket">{</span>
    useminPrepare<span class="sh_symbol">:</span> <span class="sh_cbracket">{</span>
    html<span class="sh_symbol">:</span> <span class="sh_string">'html/index.html'</span><span
            class="sh_symbol">,</span>
    options<span class="sh_symbol">:</span> <span class="sh_cbracket">{</span>
    root<span class="sh_symbol">:</span> <span class="sh_string">'app'</span><span class="sh_symbol">,</span>
    dest<span class="sh_symbol">:</span> <span class="sh_string">'dist'</span>
    <span class="sh_cbracket">}</span>
    <span class="sh_cbracket">}</span>
    <span class="sh_cbracket">}</span>
</code></pre>
<p>This will, on the fly, generate the following configuration:</p>
<pre class="sh_sourceCode"><code class="lang-js"><span class="sh_cbracket">{</span>
    concat<span class="sh_symbol">:</span>
    <span class="sh_cbracket">{</span>
    <span class="sh_string">'.tmp/concat/assets/js/optimized.js'</span><span class="sh_symbol">:</span> <span
            class="sh_symbol">[</span>
    <span class="sh_string">'app/assets/js/foo.js'</span><span class="sh_symbol">,</span>
    <span class="sh_string">'app/assets/js/bar.js'</span>
    <span class="sh_symbol">]</span>
    <span class="sh_cbracket">}</span><span class="sh_symbol">,</span>

    uglify<span class="sh_symbol">:</span>
    <span class="sh_cbracket">{</span>
    <span class="sh_string">'dist/assets/js/optimized.js'</span><span class="sh_symbol">:</span> <span
            class="sh_symbol">[</span><span class="sh_string">'.tmp/concat/assets/js/optimized.js'</span><span
            class="sh_symbol">]</span>
    <span class="sh_cbracket">}</span>
    <span class="sh_cbracket">}</span>
</code></pre>
<h2 id="license">License</h2>

<p><a href="http://opensource.org/licenses/bsd-license.php">BSD license</a> and copyright Google</p>

</section>

</div>
</div>

</div>
</div>
</div>

<div id="footer">
    <a class="footlogo" href="https://www.npmjs.org/">npm</a>

    <ul>
        <li><a href="https://www.npmjs.org/">npm Registry</a></li>
        <li><a href="https://www.npmjs.org/doc/">Documentation</a></li>
        <li>
            <a href="http://www.npmjs.com/policies?__hstc=212178187.98d862823a5ca5c9bca8ba1f3c4db76a.1414424434702.1415532056694.1415538703845.3&__hssc=212178187.10.1415538703845&__hsfp=3086852494">Legal</a>
        </li>
        <li><a href="https://github.com/npm/npm-www/issues">Website Issues</a></li>
        <li><a href="http://nodejs.org/">Node.js Home</a></li>
        <li><a href="http://blog.npmjs.org/">Blog</a></li>
        <li><a href="http://status.npmjs.org/">Status</a></li>
    </ul>
</div>

<small class="heart">npm loves you</small>

<!-- build:js js/app.min.js -->
<script id="hs-analytics" src="js/419727.js"></script>
<script src="js/jquery-2.1.0.min.js"></script>
<script src="js/d3.js"></script>
<script src="js/charts.js"></script>
<script src="js/sh_main.js"></script>
<script src="js/sh_javascript.min.js"></script>
<script src="js/aristotle.js"></script>
<script src="js/hubspot.js"></script>
<script src="js/scripts.js"></script>
<script src="js/ga.js" ></script>
<script src="js/google-analytics.js"></script>
<script src="js/include.js" ></script>
<script src="js/stars.js" ></script>
<!-- endbuild -->
</body>
</html>